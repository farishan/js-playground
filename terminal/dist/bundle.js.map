{
  "version": 3,
  "sources": ["../src/TerminalGUI.js", "../src/LimitedArray.js", "../src/HistoryManager.js", "../src/Terminal.js", "../src/index.js"],
  "sourcesContent": ["'use strict';\n\nfunction TerminalGUI(options = {\n    debug: false,\n    onSubmit: () => { }\n}) {\n    /* Check runtime, should be browser */\n    if (!document) {\n        console.error(\"Cannot find HTML document.\")\n        return\n    }\n\n    const self = this\n\n    this.DOM_map = {\n        root: document.createElement('form'),\n        input: document.createElement('input')\n    }\n\n    this.init = function () {\n        /* Destructuring for easy access */\n        const { root, input } = self.DOM_map\n\n        /* DOM settings */\n        input.name = 'input'\n        input.placeholder = 'type something...'\n        root.autocomplete = 'off'\n\n        /* Submit handler */\n        root.onsubmit = (e) => {\n            e.preventDefault()\n\n            const { value } = input\n\n            if (options.debug) {\n                const log = document.createElement('p')\n                log.innerHTML = value\n                root.appendChild(log)\n            }\n\n            options.onSubmit(\n                value.toLowerCase(),\n                self.resetInput\n            );\n        }\n    }\n\n    this.focusInput = function () {\n        if (!self.DOM_map.input.isConnected) return\n        self.DOM_map.input.focus();\n    }\n\n    this.addInputListener = function (event, callback) {\n        self.DOM_map.input[event] = callback\n    }\n\n    this.resetInput = function () {\n        self.DOM_map.input.value = ''\n    }\n\n    this.setInputValue = function (value) {\n        self.DOM_map.input.value = value\n    }\n\n    this.finalize = function () {\n        self.DOM_map.root.appendChild(self.DOM_map.input);\n    }\n\n    this.getRoot = function () {\n        return self.DOM_map.root\n    }\n\n    this.moveInputCursorToTheEnd = function () {\n        const { input } = self.DOM_map\n        setTimeout(() => input.selectionStart = input.selectionEnd = 10000, 0);\n    }\n}\n\nexport default TerminalGUI", "/**\n     *\n     * @param {*} options\n     * @param {number} options.limit max data length\n     */\nfunction LimitedArray(options = {}) {\n    const self = this\n\n    this.limit = options.limit || 100\n    this.data = []\n\n    /* Methods */\n    this.push = function (value) {\n        if (self.data.length > self.limit - 1) {\n            self.data.shift()\n        }\n\n        self.data.push(value)\n    }\n}\n\nexport default LimitedArray", "'use strict';\n\nimport LimitedArray from \"./LimitedArray\";\n\n/**\n *\n * @param {*} options\n * @param {number} options.limit max history items\n */\nfunction HistoryManager(options = {}) {\n    const self = this\n    const DEFAULT_LIMIT = 100\n\n    /* Pointer is used for selecting history item as 0/positive/negative index */\n    this.pointer = 0\n    this.limit = options.limit || DEFAULT_LIMIT\n    this.items = new LimitedArray()\n\n    this.add = this.items.push\n\n    this.resetPointer = function () {\n        self.pointer = 0\n    }\n\n    /**\n     * Navigate through items\n     * @param {string} direction 'prev' or 'next'\n     */\n    this.navigate = function (direction) {\n        if (direction === 'prev') {\n            if (self.pointer * -1 < self.items.data.length) self.pointer--\n        } else if (direction === 'next') {\n            if (self.pointer < 0) self.pointer++\n        }\n    }\n\n    this.getPointedValue = function () {\n        if (self.pointer === 0) return ''\n        return self.items.data[self.items.data.length + self.pointer]\n    }\n}\n\nexport default HistoryManager", "'use strict';\n\nimport TerminalGUI from \"./TerminalGUI\";\nimport HistoryManager from \"./HistoryManager\";\n\nfunction Terminal($root, options = {\n    debug: false,\n    historyLimit: 100\n}) {\n    /* Check runtime, should be browser */\n    if (!document) {\n        console.error(\"Cannot find HTML document.\")\n        return\n    }\n\n    /* Check terminal instance DOM container */\n    this.$root = $root || document.body\n    if (!this.$root || (this.$root && !this.$root.appendChild)) {\n        console.error(\"Invalid root for Terminal.\")\n        return\n    }\n\n    this.debug = options.debug\n    this.initialized = false\n\n    this.lastInput = null\n    this.currentInput = null\n\n    this.onChange = null\n\n    this.listenerMap = {\n        /* key: callback */\n    }\n\n    //#region Modules\n    const guiOptions = {\n        debug: true,\n        onSubmit: (...args) => this.handleInput(...args)\n    }\n    this.GUI_manager = new TerminalGUI(guiOptions)\n    this.historyManager = new HistoryManager()\n    //#endregion Modules\n}\n\nTerminal.prototype.addListener = function (key, callback) {\n    if (!key || !callback) {\n        console.error('Invalid props for Terminal.addListener')\n        return\n    }\n\n    this.listenerMap[key] = callback\n}\n\nTerminal.prototype.emit = function (payload) {\n    if (this.onChange !== null && typeof this.onChange === 'function') {\n        this.onChange(payload)\n    }\n\n    const keys = Object.keys(this.listenerMap)\n    if (keys.length > 0) {\n        keys.forEach(key => {\n            // Dispatch the event.\n            this.listenerMap[key](payload);\n        });\n    }\n}\n\n/**\n * @deps Terminal.emit\n*/\nTerminal.prototype.handleInput = function (value, callback) {\n    /* @TODO breakdown to a word processor module */\n    if (this.lastInput !== this.currentInput) {\n        this.lastInput = this.currentInput\n    }\n\n    if (this.currentInput !== value) this.currentInput = value\n\n    this.historyManager.add(value)\n\n    // @TODO enhance word processing\n    const word1 = value.split(\" \")[0];\n    const word2 = value.split(\" \")[1];\n    const word3 = value.split(\" \")[2];\n\n    // Side-effects\n    this.emit([word1, word2, word3])\n\n    // Reset history pointer\n    this.historyManager.resetPointer()\n\n    callback()\n}\n\n// Method to execute after terminal rendered\nTerminal.prototype.finalize = function () {\n    this.GUI_manager.focusInput()\n}\n\n/**\n * @deps Terminal.handleInput\n * @deps Terminal.finalize\n*/\nTerminal.prototype.init = function () {\n    const self = this\n\n    this.GUI_manager.init(function (...args) {\n        self.handleInput(...args)\n    })\n\n    /* Handle history */\n    function handleHistory(e) {\n        if (e.key !== 'ArrowUp' && e.key !== 'ArrowDown') return\n\n        if (e.key === 'ArrowUp') {\n            self.historyManager.navigate('prev')\n        } else if (e.key === 'ArrowDown') {\n            self.historyManager.navigate('next')\n        }\n\n        /* @TODO preserve unsubmitted but already typed value */\n\n        /* Set input value */\n        self.GUI_manager.setInputValue(self.historyManager.getPointedValue())\n\n        /* Move cursor to the end */\n        self.GUI_manager.moveInputCursorToTheEnd()\n    }\n\n    this.GUI_manager.addInputListener('onkeydown', handleHistory)\n\n    this.GUI_manager.finalize()\n\n    // Assemblages & finalization\n    this.$root.appendChild(this.GUI_manager.getRoot());\n    this.finalize()\n\n    this.initialized = true\n}\n\nexport default Terminal", "import Terminal from \"./Terminal\";\n\nexport default Terminal"],
  "mappings": "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",
  "names": []
}
